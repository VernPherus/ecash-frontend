[{"filePath":"C:\\Users\\admin\\Desktop\\FunWatch\\fundwatch-frontend\\src\\pages\\DisbursementFormPage.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  175 |                 try {\n  176 |                     const draft = JSON.parse(saved);\n> 177 |                     if (draft.formData) setFormData(draft.formData);\n      |                                         ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  178 |                     if (draft.items && draft.items.length > 0) setItems(draft.items);\n  179 |                     if (draft.deductions) setDeductions(draft.deductions);\n  180 |                 } catch {","line":177,"column":41,"nodeType":null,"endLine":177,"endColumn":52}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport {\r\n    ArrowLeft,\r\n    Save,\r\n    Printer,\r\n    CheckCircle2,\r\n    Clock,\r\n    FileText,\r\n    Users,\r\n    Wallet,\r\n    Receipt,\r\n    Plus,\r\n    Trash2,\r\n    ChevronRight,\r\n    ChevronLeft,\r\n    Sparkles,\r\n    AlertTriangle,\r\n    Check,\r\n    X,\r\n    GripVertical,\r\n    Calculator,\r\n    Calendar,\r\n    Hash,\r\n    Building,\r\n    CreditCard,\r\n    Send,\r\n} from \"lucide-react\";\r\nimport useDisbursementStore from \"../store/useDisbursementStore\";\r\nimport useFundStore from \"../store/useFundStore\";\r\nimport usePayeeStore from \"../store/usePayeeStore\";\r\nimport DisbursementPrintView from \"../components/DisbursementPrintView\";\r\n\r\n// ============================================\r\n// CONSTANTS & HELPERS\r\n// ============================================\r\nconst STEPS = [\r\n    { id: 1, name: \"Setup\", icon: FileText, description: \"Basic information\" },\r\n    { id: 2, name: \"Line Items\", icon: Receipt, description: \"Add expenses\" },\r\n    { id: 3, name: \"Deductions\", icon: Calculator, description: \"Tax & fees\" },\r\n    { id: 4, name: \"Review\", icon: CheckCircle2, description: \"Confirm & submit\" },\r\n];\r\n\r\nconst PAYMENT_METHODS = [\r\n    { value: \"MANUAL\", label: \"Check/Manual\", icon: CreditCard },\r\n    { value: \"ONLINE\", label: \"Online Transfer\", icon: Send },\r\n];\r\n\r\nconst DEDUCTION_TYPES = [\r\n    \"Withholding Tax\",\r\n    \"VAT\",\r\n    \"Retention Fee\",\r\n    \"Liquidated Damages\",\r\n    \"Other\",\r\n];\r\n\r\nconst formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat(\"en-PH\", {\r\n        style: \"currency\",\r\n        currency: \"PHP\",\r\n        minimumFractionDigits: 2,\r\n    }).format(amount || 0);\r\n};\r\n\r\nconst formatDate = (dateString) => {\r\n    if (!dateString) return \"\";\r\n    return new Date(dateString).toLocaleDateString(\"en-PH\", {\r\n        year: \"numeric\",\r\n        month: \"long\",\r\n        day: \"numeric\",\r\n    });\r\n};\r\n\r\n// ============================================\r\n// MAIN COMPONENT\r\n// ============================================\r\nconst DisbursementFormPage = () => {\r\n    const navigate = useNavigate();\r\n    const { id } = useParams();\r\n    const isEditing = Boolean(id);\r\n\r\n    // Stores\r\n    const { createDisbursement, updateDisbursement, showDisbursement, isLoading } = useDisbursementStore();\r\n    const { funds, fetchFunds } = useFundStore();\r\n    const { payees, fetchPayees } = usePayeeStore();\r\n\r\n    // State\r\n    const [currentStep, setCurrentStep] = useState(1);\r\n    const [showPrintPreview, setShowPrintPreview] = useState(false);\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [submitSuccess, setSubmitSuccess] = useState(false);\r\n    const [errors, setErrors] = useState({});\r\n    const [shakeFields, setShakeFields] = useState({});\r\n\r\n    // Form Data\r\n    const [formData, setFormData] = useState({\r\n        payeeId: \"\",\r\n        fundSourceId: \"\",\r\n        dateReceived: new Date().toISOString().split(\"T\")[0],\r\n        dvNum: \"\",\r\n        orsNum: \"\",\r\n        lddapNum: \"\",\r\n        acicNum: \"\",\r\n        uacsCode: \"\",\r\n        respCode: \"\",\r\n        particulars: \"\",\r\n        method: \"MANUAL\",\r\n        ageLimit: 5,\r\n    });\r\n\r\n    const [items, setItems] = useState([\r\n        { description: \"\", accountCode: \"\", amount: \"\" },\r\n    ]);\r\n\r\n    const [deductions, setDeductions] = useState([]);\r\n\r\n    // Computed values\r\n    const grossAmount = items.reduce((sum, item) => sum + Number(item.amount || 0), 0);\r\n    const totalDeductions = deductions.reduce((sum, d) => sum + Number(d.amount || 0), 0);\r\n    const netAmount = grossAmount - totalDeductions;\r\n\r\n    // Selected entities for preview\r\n    const selectedPayee = payees.find(p => p.id === Number(formData.payeeId));\r\n    const selectedFund = funds.find(f => f.id === Number(formData.fundSourceId));\r\n\r\n    // ============================================\r\n    // EFFECTS\r\n    // ============================================\r\n    useEffect(() => {\r\n        fetchFunds();\r\n        fetchPayees();\r\n    }, [fetchFunds, fetchPayees]);\r\n\r\n    useEffect(() => {\r\n        const loadExistingDisbursement = async (disbursementId) => {\r\n            const data = await showDisbursement(disbursementId);\r\n            if (data) {\r\n                setFormData({\r\n                    payeeId: data.payeeId || \"\",\r\n                    fundSourceId: data.fundSourceId || \"\",\r\n                    dateReceived: data.dateReceived?.split(\"T\")[0] || \"\",\r\n                    dvNum: data.dvNum || \"\",\r\n                    orsNum: data.orsNum || \"\",\r\n                    lddapNum: data.lddapNum || \"\",\r\n                    acicNum: data.acicNum || \"\",\r\n                    uacsCode: data.uacsCode || \"\",\r\n                    respCode: data.respCode || \"\",\r\n                    particulars: data.particulars || \"\",\r\n                    method: data.method || \"MANUAL\",\r\n                    ageLimit: data.ageLimit || 5,\r\n                });\r\n                if (data.items?.length > 0) setItems(data.items);\r\n                if (data.deductions?.length > 0) setDeductions(data.deductions);\r\n            }\r\n        };\r\n\r\n        if (isEditing && id) {\r\n            loadExistingDisbursement(id);\r\n        }\r\n    }, [id, isEditing, showDisbursement]);\r\n\r\n    // Auto-save draft to localStorage\r\n    useEffect(() => {\r\n        if (!isEditing && !submitSuccess) {\r\n            const draft = { formData, items, deductions, currentStep };\r\n            localStorage.setItem(\"disbursement_draft\", JSON.stringify(draft));\r\n        }\r\n    }, [formData, items, deductions, currentStep, isEditing, submitSuccess]);\r\n\r\n    // Load draft on mount\r\n    useEffect(() => {\r\n        if (!isEditing) {\r\n            const saved = localStorage.getItem(\"disbursement_draft\");\r\n            if (saved) {\r\n                try {\r\n                    const draft = JSON.parse(saved);\r\n                    if (draft.formData) setFormData(draft.formData);\r\n                    if (draft.items && draft.items.length > 0) setItems(draft.items);\r\n                    if (draft.deductions) setDeductions(draft.deductions);\r\n                } catch {\r\n                    // Invalid draft, ignore\r\n                }\r\n            }\r\n        }\r\n    }, [isEditing]);\r\n\r\n    // ============================================\r\n    // HANDLERS\r\n    // ============================================\r\n    const handleChange = useCallback((e) => {\r\n        const { name, value } = e.target;\r\n        setFormData(prev => ({ ...prev, [name]: value }));\r\n        if (errors[name]) {\r\n            setErrors(prev => ({ ...prev, [name]: undefined }));\r\n        }\r\n    }, [errors]);\r\n\r\n    const handleItemChange = useCallback((index, field, value) => {\r\n        setItems(prev => {\r\n            const newItems = [...prev];\r\n            newItems[index] = { ...newItems[index], [field]: value };\r\n            return newItems;\r\n        });\r\n    }, []);\r\n\r\n    const addItem = useCallback(() => {\r\n        setItems(prev => [...prev, { description: \"\", accountCode: \"\", amount: \"\" }]);\r\n    }, []);\r\n\r\n    const removeItem = useCallback((index) => {\r\n        if (items.length > 1) {\r\n            setItems(prev => prev.filter((_, i) => i !== index));\r\n        }\r\n    }, [items.length]);\r\n\r\n    const handleDeductionChange = useCallback((index, field, value) => {\r\n        setDeductions(prev => {\r\n            const newDeductions = [...prev];\r\n            newDeductions[index] = { ...newDeductions[index], [field]: value };\r\n            return newDeductions;\r\n        });\r\n    }, []);\r\n\r\n    const addDeduction = useCallback(() => {\r\n        setDeductions(prev => [...prev, { deductionType: \"\", amount: \"\" }]);\r\n    }, []);\r\n\r\n    const removeDeduction = useCallback((index) => {\r\n        setDeductions(prev => prev.filter((_, i) => i !== index));\r\n    }, []);\r\n\r\n    // ============================================\r\n    // VALIDATION\r\n    // ============================================\r\n    const validateStep = (stepNum) => {\r\n        const newErrors = {};\r\n        const fieldsToShake = {};\r\n\r\n        if (stepNum === 1) {\r\n            if (!formData.payeeId) {\r\n                newErrors.payeeId = \"Please select a payee\";\r\n                fieldsToShake.payeeId = true;\r\n            }\r\n            if (!formData.fundSourceId) {\r\n                newErrors.fundSourceId = \"Please select a fund source\";\r\n                fieldsToShake.fundSourceId = true;\r\n            }\r\n            if (!formData.dateReceived) {\r\n                newErrors.dateReceived = \"Date is required\";\r\n                fieldsToShake.dateReceived = true;\r\n            }\r\n        }\r\n\r\n        if (stepNum === 2) {\r\n            const validItems = items.filter(item => item.description && item.amount);\r\n            if (validItems.length === 0) {\r\n                newErrors.items = \"At least one line item with description and amount is required\";\r\n                fieldsToShake.items = true;\r\n            }\r\n            items.forEach((item, idx) => {\r\n                if (item.description && !item.amount) {\r\n                    newErrors[`item_${idx}_amount`] = \"Amount required\";\r\n                    fieldsToShake[`item_${idx}`] = true;\r\n                }\r\n                if (item.amount && Number(item.amount) < 0) {\r\n                    newErrors[`item_${idx}_amount`] = \"Amount must be positive\";\r\n                    fieldsToShake[`item_${idx}`] = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        if (stepNum === 3) {\r\n            deductions.forEach((d, idx) => {\r\n                if (d.amount && Number(d.amount) < 0) {\r\n                    newErrors[`deduction_${idx}_amount`] = \"Amount must be positive\";\r\n                    fieldsToShake[`deduction_${idx}`] = true;\r\n                }\r\n                if (d.amount && !d.deductionType) {\r\n                    newErrors[`deduction_${idx}_type`] = \"Please select type\";\r\n                    fieldsToShake[`deduction_${idx}`] = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        setErrors(newErrors);\r\n\r\n        // Trigger shake animation\r\n        if (Object.keys(fieldsToShake).length > 0) {\r\n            setShakeFields(fieldsToShake);\r\n            setTimeout(() => setShakeFields({}), 500);\r\n        }\r\n\r\n        return Object.keys(newErrors).length === 0;\r\n    };\r\n\r\n    const handleNext = () => {\r\n        if (validateStep(currentStep)) {\r\n            setCurrentStep(prev => Math.min(prev + 1, 4));\r\n        }\r\n    };\r\n\r\n    const handleBack = () => {\r\n        setCurrentStep(prev => Math.max(prev - 1, 1));\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        if (!validateStep(currentStep)) return;\r\n\r\n        setIsSubmitting(true);\r\n\r\n        const payload = {\r\n            ...formData,\r\n            payeeId: Number(formData.payeeId),\r\n            fundSourceId: Number(formData.fundSourceId),\r\n            grossAmount,\r\n            totalDeductions,\r\n            netAmount,\r\n            items: items.filter(i => i.description && i.amount).map(item => ({\r\n                ...item,\r\n                amount: Number(item.amount),\r\n            })),\r\n            deductions: deductions.filter(d => d.deductionType && d.amount).map(d => ({\r\n                ...d,\r\n                amount: Number(d.amount),\r\n            })),\r\n        };\r\n\r\n        let result;\r\n        if (isEditing) {\r\n            result = await updateDisbursement(id, payload);\r\n        } else {\r\n            result = await createDisbursement(payload);\r\n        }\r\n\r\n        setIsSubmitting(false);\r\n\r\n        if (result.success) {\r\n            setSubmitSuccess(true);\r\n            localStorage.removeItem(\"disbursement_draft\");\r\n            setTimeout(() => {\r\n                navigate(`/disbursement/${result.disbursement?.id || id}`);\r\n            }, 2000);\r\n        }\r\n    };\r\n\r\n    const clearDraft = () => {\r\n        localStorage.removeItem(\"disbursement_draft\");\r\n        setFormData({\r\n            payeeId: \"\",\r\n            fundSourceId: \"\",\r\n            dateReceived: new Date().toISOString().split(\"T\")[0],\r\n            dvNum: \"\",\r\n            orsNum: \"\",\r\n            lddapNum: \"\",\r\n            acicNum: \"\",\r\n            uacsCode: \"\",\r\n            respCode: \"\",\r\n            particulars: \"\",\r\n            method: \"MANUAL\",\r\n            ageLimit: 5,\r\n        });\r\n        setItems([{ description: \"\", accountCode: \"\", amount: \"\" }]);\r\n        setDeductions([]);\r\n        setCurrentStep(1);\r\n    };\r\n\r\n    // ============================================\r\n    // RENDER HELPERS\r\n    // ============================================\r\n    const getStepStatus = (stepId) => {\r\n        if (stepId < currentStep) return \"completed\";\r\n        if (stepId === currentStep) return \"current\";\r\n        return \"upcoming\";\r\n    };\r\n\r\n    // ============================================\r\n    // PRINT PREVIEW\r\n    // ============================================\r\n    if (showPrintPreview) {\r\n        return (\r\n            <DisbursementPrintView\r\n                disbursement={{\r\n                    ...formData,\r\n                    grossAmount,\r\n                    totalDeductions,\r\n                    netAmount,\r\n                    items: items.filter(i => i.description),\r\n                    deductions: deductions.filter(d => d.deductionType),\r\n                    payee: selectedPayee,\r\n                    fundSource: selectedFund,\r\n                }}\r\n                onClose={() => setShowPrintPreview(false)}\r\n            />\r\n        );\r\n    }\r\n\r\n    // ============================================\r\n    // SUCCESS STATE\r\n    // ============================================\r\n    if (submitSuccess) {\r\n        return (\r\n            <div className=\"min-h-screen bg-base-200 flex items-center justify-center\">\r\n                <div className=\"text-center animate-fade-in-up\">\r\n                    <div className=\"w-24 h-24 mx-auto mb-6 rounded-full bg-success/20 flex items-center justify-center\">\r\n                        <CheckCircle2 className=\"w-12 h-12 text-success animate-pulse\" />\r\n                    </div>\r\n                    <h2 className=\"text-2xl font-bold text-base-content mb-2\">\r\n                        {isEditing ? \"Disbursement Updated!\" : \"Disbursement Created!\"}\r\n                    </h2>\r\n                    <p className=\"text-base-content/60 mb-4\">\r\n                        Redirecting to disbursement details...\r\n                    </p>\r\n                    <span className=\"loading loading-dots loading-md text-primary\"></span>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // ============================================\r\n    // MAIN RENDER\r\n    // ============================================\r\n    return (\r\n        <div className=\"min-h-screen bg-base-200 pb-24\">\r\n            {/* Header */}\r\n            <header className=\"bg-base-100 border-b border-base-300 px-6 lg:px-8 py-5 sticky top-0 z-20 shadow-soft\">\r\n                <div className=\"flex justify-between items-center max-w-7xl mx-auto\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <button\r\n                            onClick={() => navigate(-1)}\r\n                            className=\"btn btn-ghost btn-sm btn-square hover:bg-base-200\"\r\n                        >\r\n                            <ArrowLeft className=\"w-5 h-5\" />\r\n                        </button>\r\n                        <div>\r\n                            <h1 className=\"text-xl lg:text-2xl font-bold text-base-content\">\r\n                                {isEditing ? \"Edit Disbursement\" : \"New Disbursement\"}\r\n                            </h1>\r\n                            <p className=\"text-sm text-base-content/60 hidden sm:block\">\r\n                                {isEditing ? \"Update disbursement record\" : \"Create a new disbursement voucher\"}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        {!isEditing && (\r\n                            <button\r\n                                onClick={clearDraft}\r\n                                className=\"btn btn-ghost btn-sm gap-2 text-error hover:bg-error/10\"\r\n                            >\r\n                                <X className=\"w-4 h-4\" />\r\n                                <span className=\"hidden sm:inline\">Clear</span>\r\n                            </button>\r\n                        )}\r\n                        <button\r\n                            onClick={() => setShowPrintPreview(true)}\r\n                            className=\"btn btn-ghost btn-sm gap-2\"\r\n                            disabled={!formData.payeeId || items.every(i => !i.description)}\r\n                        >\r\n                            <Printer className=\"w-4 h-4\" />\r\n                            <span className=\"hidden sm:inline\">Preview</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Progress Steps */}\r\n            <div className=\"bg-base-100 border-b border-base-300 px-6 lg:px-8 py-4\">\r\n                <div className=\"max-w-7xl mx-auto\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        {STEPS.map((step, idx) => {\r\n                            const status = getStepStatus(step.id);\r\n                            const StepIcon = step.icon;\r\n                            return (\r\n                                <React.Fragment key={step.id}>\r\n                                    <button\r\n                                        onClick={() => {\r\n                                            if (status === \"completed\") setCurrentStep(step.id);\r\n                                        }}\r\n                                        disabled={status === \"upcoming\"}\r\n                                        className={`flex items-center gap-3 transition-all ${status === \"completed\" ? \"cursor-pointer\" : \"\"\r\n                                            } ${status === \"upcoming\" ? \"opacity-40\" : \"\"}`}\r\n                                    >\r\n                                        <div\r\n                                            className={`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${status === \"current\"\r\n                                                ? \"bg-primary text-white shadow-glow-primary\"\r\n                                                : status === \"completed\"\r\n                                                    ? \"bg-success text-white\"\r\n                                                    : \"bg-base-200 text-base-content/40\"\r\n                                                }`}\r\n                                        >\r\n                                            {status === \"completed\" ? (\r\n                                                <Check className=\"w-5 h-5\" />\r\n                                            ) : (\r\n                                                <StepIcon className=\"w-5 h-5\" />\r\n                                            )}\r\n                                        </div>\r\n                                        <div className=\"hidden md:block text-left\">\r\n                                            <p className={`text-sm font-semibold ${status === \"current\" ? \"text-primary\" : \"text-base-content\"\r\n                                                }`}>\r\n                                                {step.name}\r\n                                            </p>\r\n                                            <p className=\"text-xs text-base-content/50\">{step.description}</p>\r\n                                        </div>\r\n                                    </button>\r\n                                    {idx < STEPS.length - 1 && (\r\n                                        <div className={`flex-1 h-0.5 mx-2 lg:mx-4 rounded transition-all ${status === \"completed\" ? \"bg-success\" : \"bg-base-300\"\r\n                                            }`} />\r\n                                    )}\r\n                                </React.Fragment>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Main Content - Split Layout */}\r\n            <div className=\"max-w-7xl mx-auto px-6 lg:px-8 py-8\">\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                    {/* Form Panel */}\r\n                    <div className=\"lg:col-span-2\">\r\n                        <div className=\"card-static p-6 lg:p-8\">\r\n                            {/* Step 1: Setup */}\r\n                            {currentStep === 1 && (\r\n                                <div className=\"space-y-6 animate-fade-in-up\">\r\n                                    <div className=\"flex items-center gap-3 mb-6\">\r\n                                        <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center\">\r\n                                            <FileText className=\"w-5 h-5 text-primary\" />\r\n                                        </div>\r\n                                        <div>\r\n                                            <h2 className=\"text-lg font-bold\">Basic Information</h2>\r\n                                            <p className=\"text-sm text-base-content/60\">Set up the disbursement details</p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Validation Error Summary Panel */}\r\n                                    {Object.keys(errors).length > 0 && currentStep === 1 && (\r\n                                        <div className=\"bg-gradient-to-r from-error/10 via-error/5 to-transparent border border-error/30 rounded-xl p-4 animate-slide-in-up\">\r\n                                            <div className=\"flex items-start gap-3\">\r\n                                                <div className=\"w-10 h-10 rounded-full bg-error/20 flex items-center justify-center flex-shrink-0 animate-error-bounce\">\r\n                                                    <AlertTriangle className=\"w-5 h-5 text-error\" />\r\n                                                </div>\r\n                                                <div className=\"flex-1\">\r\n                                                    <h4 className=\"font-bold text-error mb-1\">Please fix the following issues:</h4>\r\n                                                    <ul className=\"text-sm text-base-content/70 space-y-1\">\r\n                                                        {errors.payeeId && (\r\n                                                            <li className=\"flex items-center gap-2\">\r\n                                                                <span className=\"w-1.5 h-1.5 rounded-full bg-error\"></span>\r\n                                                                {errors.payeeId}\r\n                                                            </li>\r\n                                                        )}\r\n                                                        {errors.fundSourceId && (\r\n                                                            <li className=\"flex items-center gap-2\">\r\n                                                                <span className=\"w-1.5 h-1.5 rounded-full bg-error\"></span>\r\n                                                                {errors.fundSourceId}\r\n                                                            </li>\r\n                                                        )}\r\n                                                        {errors.dateReceived && (\r\n                                                            <li className=\"flex items-center gap-2\">\r\n                                                                <span className=\"w-1.5 h-1.5 rounded-full bg-error\"></span>\r\n                                                                {errors.dateReceived}\r\n                                                            </li>\r\n                                                        )}\r\n                                                    </ul>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* Payee Selection */}\r\n                                    <div className=\"form-control\">\r\n                                        <label className=\"label\">\r\n                                            <span className=\"label-text font-semibold flex items-center gap-2\">\r\n                                                <Users className=\"w-4 h-4 text-primary\" />\r\n                                                Payee <span className=\"text-error\">*</span>\r\n                                            </span>\r\n                                        </label>\r\n                                        <select\r\n                                            name=\"payeeId\"\r\n                                            className={`select select-bordered w-full ${errors.payeeId ? \"select-error field-error-glow\" : \"\"} ${shakeFields.payeeId ? \"animate-shake\" : \"\"}`}\r\n                                            value={formData.payeeId}\r\n                                            onChange={handleChange}\r\n                                        >\r\n                                            <option value=\"\">Select a payee...</option>\r\n                                            {payees.map((p) => (\r\n                                                <option key={p.id} value={p.id}>\r\n                                                    {p.name} {p.type ? `(${p.type})` : \"\"}\r\n                                                </option>\r\n                                            ))}\r\n                                        </select>\r\n                                        {errors.payeeId && (\r\n                                            <label className=\"label\">\r\n                                                <span className=\"label-text-alt text-error flex items-center gap-1\">\r\n                                                    <AlertTriangle className=\"w-3 h-3\" />\r\n                                                    {errors.payeeId}\r\n                                                </span>\r\n                                            </label>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    {/* Fund Source Selection */}\r\n                                    <div className=\"form-control\">\r\n                                        <label className=\"label\">\r\n                                            <span className=\"label-text font-semibold flex items-center gap-2\">\r\n                                                <Wallet className=\"w-4 h-4 text-primary\" />\r\n                                                Fund Source <span className=\"text-error\">*</span>\r\n                                            </span>\r\n                                        </label>\r\n                                        <select\r\n                                            name=\"fundSourceId\"\r\n                                            className={`select select-bordered w-full ${errors.fundSourceId ? \"select-error field-error-glow\" : \"\"} ${shakeFields.fundSourceId ? \"animate-shake\" : \"\"}`}\r\n                                            value={formData.fundSourceId}\r\n                                            onChange={handleChange}\r\n                                        >\r\n                                            <option value=\"\">Select a fund source...</option>\r\n                                            {funds.map((f) => (\r\n                                                <option key={f.id} value={f.id}>\r\n                                                    {f.code} - {f.name}\r\n                                                </option>\r\n                                            ))}\r\n                                        </select>\r\n                                        {selectedFund && (\r\n                                            <label className=\"label\">\r\n                                                <span className=\"label-text-alt text-success flex items-center gap-1\">\r\n                                                    Available: {formatCurrency(selectedFund.initialBalance)}\r\n                                                </span>\r\n                                            </label>\r\n                                        )}\r\n                                        {errors.fundSourceId && (\r\n                                            <label className=\"label\">\r\n                                                <span className=\"label-text-alt text-error flex items-center gap-1\">\r\n                                                    <AlertTriangle className=\"w-3 h-3\" />\r\n                                                    {errors.fundSourceId}\r\n                                                </span>\r\n                                            </label>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    {/* Date & Method Row */}\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                        <div className=\"form-control\">\r\n                                            <label className=\"label\">\r\n                                                <span className=\"label-text font-semibold flex items-center gap-2\">\r\n                                                    <Calendar className=\"w-4 h-4 text-primary\" />\r\n                                                    Date Received <span className=\"text-error\">*</span>\r\n                                                </span>\r\n                                            </label>\r\n                                            <input\r\n                                                type=\"date\"\r\n                                                name=\"dateReceived\"\r\n                                                className={`input input-bordered w-full ${errors.dateReceived ? \"input-error field-error-glow\" : \"\"} ${shakeFields.dateReceived ? \"animate-shake\" : \"\"}`}\r\n                                                value={formData.dateReceived}\r\n                                                onChange={handleChange}\r\n                                            />\r\n                                        </div>\r\n\r\n                                        <div className=\"form-control\">\r\n                                            <label className=\"label\">\r\n                                                <span className=\"label-text font-semibold\">Payment Method</span>\r\n                                            </label>\r\n                                            <div className=\"flex gap-2\">\r\n                                                {PAYMENT_METHODS.map((method) => {\r\n                                                    const MethodIcon = method.icon;\r\n                                                    const isSelected = formData.method === method.value;\r\n                                                    return (\r\n                                                        <button\r\n                                                            key={method.value}\r\n                                                            type=\"button\"\r\n                                                            onClick={() => handleChange({ target: { name: \"method\", value: method.value } })}\r\n                                                            className={`flex-1 btn ${isSelected ? \"btn-primary\" : \"btn-ghost border border-base-300\"} gap-2`}\r\n                                                        >\r\n                                                            <MethodIcon className=\"w-4 h-4\" />\r\n                                                            {method.label}\r\n                                                        </button>\r\n                                                    );\r\n                                                })}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Particulars */}\r\n                                    <div className=\"form-control\">\r\n                                        <label className=\"label\">\r\n                                            <span className=\"label-text font-semibold\">Particulars / Description</span>\r\n                                        </label>\r\n                                        <textarea\r\n                                            name=\"particulars\"\r\n                                            placeholder=\"Brief description of the disbursement purpose...\"\r\n                                            className=\"textarea textarea-bordered h-24 resize-none\"\r\n                                            value={formData.particulars}\r\n                                            onChange={handleChange}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Step 2: Line Items */}\r\n                            {currentStep === 2 && (\r\n                                <div className=\"space-y-6 animate-fade-in-up\">\r\n                                    <div className=\"flex items-center justify-between mb-6\">\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center\">\r\n                                                <Receipt className=\"w-5 h-5 text-primary\" />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h2 className=\"text-lg font-bold\">Line Items</h2>\r\n                                                <p className=\"text-sm text-base-content/60\">Add expense items to this disbursement</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <button\r\n                                            type=\"button\"\r\n                                            onClick={addItem}\r\n                                            className=\"btn btn-primary btn-sm gap-2\"\r\n                                        >\r\n                                            <Plus className=\"w-4 h-4\" />\r\n                                            Add Item\r\n                                        </button>\r\n                                    </div>\r\n\r\n                                    {errors.items && (\r\n                                        <div className=\"alert alert-error\">\r\n                                            <AlertTriangle className=\"w-5 h-5\" />\r\n                                            <span>{errors.items}</span>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    <div className=\"space-y-4\">\r\n                                        {items.map((item, idx) => (\r\n                                            <div\r\n                                                key={idx}\r\n                                                className=\"bg-base-200/50 rounded-xl p-4 border border-base-300 hover:border-primary/30 transition-all\"\r\n                                            >\r\n                                                <div className=\"flex items-start gap-3\">\r\n                                                    <div className=\"pt-2 text-base-content/30 cursor-grab\">\r\n                                                        <GripVertical className=\"w-5 h-5\" />\r\n                                                    </div>\r\n                                                    <div className=\"flex-1 space-y-3\">\r\n                                                        <div className=\"flex items-center justify-between\">\r\n                                                            <span className=\"text-sm font-semibold text-base-content/60\">\r\n                                                                Item {idx + 1}\r\n                                                            </span>\r\n                                                            {items.length > 1 && (\r\n                                                                <button\r\n                                                                    type=\"button\"\r\n                                                                    onClick={() => removeItem(idx)}\r\n                                                                    className=\"btn btn-ghost btn-xs text-error hover:bg-error/10\"\r\n                                                                >\r\n                                                                    <Trash2 className=\"w-4 h-4\" />\r\n                                                                </button>\r\n                                                            )}\r\n                                                        </div>\r\n                                                        <input\r\n                                                            type=\"text\"\r\n                                                            placeholder=\"Description (e.g., Office Supplies)\"\r\n                                                            className=\"input input-bordered w-full\"\r\n                                                            value={item.description}\r\n                                                            onChange={(e) => handleItemChange(idx, \"description\", e.target.value)}\r\n                                                        />\r\n                                                        <div className=\"grid grid-cols-2 gap-3\">\r\n                                                            <input\r\n                                                                type=\"text\"\r\n                                                                placeholder=\"Account Code\"\r\n                                                                className=\"input input-bordered input-sm font-mono\"\r\n                                                                value={item.accountCode}\r\n                                                                onChange={(e) => handleItemChange(idx, \"accountCode\", e.target.value)}\r\n                                                            />\r\n                                                            <div className=\"relative\">\r\n                                                                <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-base-content/50 font-semibold\">\r\n                                                                    ₱\r\n                                                                </span>\r\n                                                                <input\r\n                                                                    type=\"number\"\r\n                                                                    placeholder=\"0.00\"\r\n                                                                    step=\"0.01\"\r\n                                                                    min=\"0\"\r\n                                                                    className={`input input-bordered input-sm w-full pl-8 font-semibold ${errors[`item_${idx}_amount`] ? \"input-error\" : \"\"\r\n                                                                        }`}\r\n                                                                    value={item.amount}\r\n                                                                    onChange={(e) => handleItemChange(idx, \"amount\", e.target.value)}\r\n                                                                />\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n\r\n                                    {/* Items Total */}\r\n                                    <div className=\"bg-primary/5 border border-primary/20 rounded-xl p-4\">\r\n                                        <div className=\"flex justify-between items-center\">\r\n                                            <span className=\"font-semibold text-base-content\">Gross Total</span>\r\n                                            <span className=\"text-xl font-bold text-primary\">\r\n                                                {formatCurrency(grossAmount)}\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Step 3: Deductions */}\r\n                            {currentStep === 3 && (\r\n                                <div className=\"space-y-6 animate-fade-in-up\">\r\n                                    <div className=\"flex items-center justify-between mb-6\">\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <div className=\"w-10 h-10 rounded-xl bg-error/10 flex items-center justify-center\">\r\n                                                <Calculator className=\"w-5 h-5 text-error\" />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h2 className=\"text-lg font-bold\">Deductions</h2>\r\n                                                <p className=\"text-sm text-base-content/60\">Add taxes, fees, or other deductions (optional)</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <button\r\n                                            type=\"button\"\r\n                                            onClick={addDeduction}\r\n                                            className=\"btn btn-outline btn-error btn-sm gap-2\"\r\n                                        >\r\n                                            <Plus className=\"w-4 h-4\" />\r\n                                            Add Deduction\r\n                                        </button>\r\n                                    </div>\r\n\r\n                                    {deductions.length === 0 ? (\r\n                                        <div className=\"text-center py-12 text-base-content/40\">\r\n                                            <Calculator className=\"w-12 h-12 mx-auto mb-4 opacity-30\" />\r\n                                            <p className=\"font-medium\">No deductions added</p>\r\n                                            <p className=\"text-sm\">Click \"Add Deduction\" to include taxes or fees</p>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"space-y-3\">\r\n                                            {deductions.map((deduction, idx) => (\r\n                                                <div\r\n                                                    key={idx}\r\n                                                    className=\"bg-error/5 border border-error/20 rounded-xl p-4\"\r\n                                                >\r\n                                                    <div className=\"flex items-center gap-3\">\r\n                                                        <div className=\"flex-1\">\r\n                                                            <select\r\n                                                                className={`select select-bordered select-sm w-full ${errors[`deduction_${idx}_type`] ? \"select-error\" : \"\"\r\n                                                                    }`}\r\n                                                                value={deduction.deductionType}\r\n                                                                onChange={(e) => handleDeductionChange(idx, \"deductionType\", e.target.value)}\r\n                                                            >\r\n                                                                <option value=\"\">Select type...</option>\r\n                                                                {DEDUCTION_TYPES.map(type => (\r\n                                                                    <option key={type} value={type}>{type}</option>\r\n                                                                ))}\r\n                                                            </select>\r\n                                                        </div>\r\n                                                        <div className=\"relative w-36\">\r\n                                                            <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-error/70 font-semibold\">\r\n                                                                -₱\r\n                                                            </span>\r\n                                                            <input\r\n                                                                type=\"number\"\r\n                                                                placeholder=\"0.00\"\r\n                                                                step=\"0.01\"\r\n                                                                min=\"0\"\r\n                                                                className=\"input input-bordered input-sm w-full pl-10 text-error font-semibold\"\r\n                                                                value={deduction.amount}\r\n                                                                onChange={(e) => handleDeductionChange(idx, \"amount\", e.target.value)}\r\n                                                            />\r\n                                                        </div>\r\n                                                        <button\r\n                                                            type=\"button\"\r\n                                                            onClick={() => removeDeduction(idx)}\r\n                                                            className=\"btn btn-ghost btn-sm btn-square text-error\"\r\n                                                        >\r\n                                                            <Trash2 className=\"w-4 h-4\" />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* Deductions Summary */}\r\n                                    <div className=\"bg-base-100 border border-base-300 rounded-xl p-4 space-y-3\">\r\n                                        <div className=\"flex justify-between text-sm\">\r\n                                            <span className=\"text-base-content/60\">Gross Amount</span>\r\n                                            <span className=\"font-medium\">{formatCurrency(grossAmount)}</span>\r\n                                        </div>\r\n                                        <div className=\"flex justify-between text-sm\">\r\n                                            <span className=\"text-error\">Total Deductions</span>\r\n                                            <span className=\"font-medium text-error\">-{formatCurrency(totalDeductions)}</span>\r\n                                        </div>\r\n                                        <div className=\"divider my-1\"></div>\r\n                                        <div className=\"flex justify-between\">\r\n                                            <span className=\"font-bold\">Net Amount</span>\r\n                                            <span className=\"text-xl font-bold text-primary\">{formatCurrency(netAmount)}</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Step 4: Review */}\r\n                            {currentStep === 4 && (\r\n                                <div className=\"space-y-6 animate-fade-in-up\">\r\n                                    <div className=\"flex items-center gap-3 mb-6\">\r\n                                        <div className=\"w-10 h-10 rounded-xl bg-success/10 flex items-center justify-center\">\r\n                                            <CheckCircle2 className=\"w-5 h-5 text-success\" />\r\n                                        </div>\r\n                                        <div>\r\n                                            <h2 className=\"text-lg font-bold\">Review & Submit</h2>\r\n                                            <p className=\"text-sm text-base-content/60\">Confirm all details before submitting</p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Reference Codes */}\r\n                                    <div className=\"bg-base-200/50 rounded-xl p-6 space-y-4\">\r\n                                        <h3 className=\"font-semibold flex items-center gap-2\">\r\n                                            <Hash className=\"w-4 h-4 text-primary\" />\r\n                                            Reference Codes (Optional)\r\n                                        </h3>\r\n                                        <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\r\n                                            <div className=\"form-control\">\r\n                                                <label className=\"label py-1\">\r\n                                                    <span className=\"label-text text-xs\">DV Number</span>\r\n                                                </label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    name=\"dvNum\"\r\n                                                    placeholder=\"DV-XXXX\"\r\n                                                    className=\"input input-bordered input-sm font-mono\"\r\n                                                    value={formData.dvNum}\r\n                                                    onChange={handleChange}\r\n                                                />\r\n                                            </div>\r\n                                            <div className=\"form-control\">\r\n                                                <label className=\"label py-1\">\r\n                                                    <span className=\"label-text text-xs\">ORS Number</span>\r\n                                                </label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    name=\"orsNum\"\r\n                                                    placeholder=\"ORS-XXXX\"\r\n                                                    className=\"input input-bordered input-sm font-mono\"\r\n                                                    value={formData.orsNum}\r\n                                                    onChange={handleChange}\r\n                                                />\r\n                                            </div>\r\n                                            <div className=\"form-control\">\r\n                                                <label className=\"label py-1\">\r\n                                                    <span className=\"label-text text-xs\">LDDAP Number</span>\r\n                                                </label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    name=\"lddapNum\"\r\n                                                    className=\"input input-bordered input-sm font-mono\"\r\n                                                    value={formData.lddapNum}\r\n                                                    onChange={handleChange}\r\n                                                />\r\n                                            </div>\r\n                                            <div className=\"form-control\">\r\n                                                <label className=\"label py-1\">\r\n                                                    <span className=\"label-text text-xs\">ACIC Number</span>\r\n                                                </label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    name=\"acicNum\"\r\n                                                    className=\"input input-bordered input-sm font-mono\"\r\n                                                    value={formData.acicNum}\r\n                                                    onChange={handleChange}\r\n                                                />\r\n                                            </div>\r\n                                            <div className=\"form-control\">\r\n                                                <label className=\"label py-1\">\r\n                                                    <span className=\"label-text text-xs\">UACS Code</span>\r\n                                                </label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    name=\"uacsCode\"\r\n                                                    className=\"input input-bordered input-sm font-mono\"\r\n                                                    value={formData.uacsCode}\r\n                                                    onChange={handleChange}\r\n                                                />\r\n                                            </div>\r\n                                            <div className=\"form-control\">\r\n                                                <label className=\"label py-1\">\r\n                                                    <span className=\"label-text text-xs\">RESP Code</span>\r\n                                                </label>\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    name=\"respCode\"\r\n                                                    className=\"input input-bordered input-sm font-mono\"\r\n                                                    value={formData.respCode}\r\n                                                    onChange={handleChange}\r\n                                                />\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Summary Table */}\r\n                                    <div className=\"bg-base-200/50 rounded-xl overflow-hidden\">\r\n                                        <div className=\"px-6 py-4 border-b border-base-300\">\r\n                                            <h3 className=\"font-semibold\">Items Summary</h3>\r\n                                        </div>\r\n                                        <table className=\"table-modern\">\r\n                                            <thead>\r\n                                                <tr>\r\n                                                    <th>Description</th>\r\n                                                    <th>Account</th>\r\n                                                    <th className=\"text-right\">Amount</th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            <tbody>\r\n                                                {items.filter(i => i.description).map((item, idx) => (\r\n                                                    <tr key={idx}>\r\n                                                        <td>{item.description}</td>\r\n                                                        <td className=\"font-mono text-sm\">{item.accountCode || \"—\"}</td>\r\n                                                        <td className=\"text-right font-semibold\">{formatCurrency(item.amount)}</td>\r\n                                                    </tr>\r\n                                                ))}\r\n                                            </tbody>\r\n                                        </table>\r\n                                    </div>\r\n\r\n                                    {/* Final Amount Card */}\r\n                                    <div className=\"bg-gradient-to-br from-primary to-primary/80 text-white rounded-xl p-6\">\r\n                                        <div className=\"flex justify-between items-center\">\r\n                                            <div>\r\n                                                <p className=\"text-white/70 text-sm mb-1\">Net Amount to Disburse</p>\r\n                                                <p className=\"text-3xl font-bold\">{formatCurrency(netAmount)}</p>\r\n                                            </div>\r\n                                            <div className=\"w-16 h-16 rounded-full bg-white/10 flex items-center justify-center\">\r\n                                                <Sparkles className=\"w-8 h-8 text-white/80\" />\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Preview Panel (Sidebar) */}\r\n                    <div className=\"lg:col-span-1\">\r\n                        <div className=\"card-static p-6 sticky top-36\">\r\n                            <h3 className=\"font-bold text-base mb-4 flex items-center gap-2\">\r\n                                <FileText className=\"w-4 h-4 text-primary\" />\r\n                                Live Preview\r\n                            </h3>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                {/* Payee */}\r\n                                <div className=\"bg-base-200/50 rounded-lg p-3\">\r\n                                    <p className=\"text-xs text-base-content/50 uppercase tracking-wide mb-1\">Payee</p>\r\n                                    <p className=\"font-semibold truncate\">\r\n                                        {selectedPayee?.name || <span className=\"text-base-content/30\">Not selected</span>}\r\n                                    </p>\r\n                                </div>\r\n\r\n                                {/* Fund Source */}\r\n                                <div className=\"bg-base-200/50 rounded-lg p-3\">\r\n                                    <p className=\"text-xs text-base-content/50 uppercase tracking-wide mb-1\">Fund Source</p>\r\n                                    <p className=\"font-semibold truncate\">\r\n                                        {selectedFund ? (\r\n                                            <>\r\n                                                <span className=\"text-primary\">{selectedFund.code}</span>\r\n                                                <span className=\"text-base-content/60 ml-1\">• {selectedFund.name}</span>\r\n                                            </>\r\n                                        ) : (\r\n                                            <span className=\"text-base-content/30\">Not selected</span>\r\n                                        )}\r\n                                    </p>\r\n                                </div>\r\n\r\n                                {/* Date */}\r\n                                <div className=\"bg-base-200/50 rounded-lg p-3\">\r\n                                    <p className=\"text-xs text-base-content/50 uppercase tracking-wide mb-1\">Date Received</p>\r\n                                    <p className=\"font-semibold\">\r\n                                        {formData.dateReceived ? formatDate(formData.dateReceived) : <span className=\"text-base-content/30\">Not set</span>}\r\n                                    </p>\r\n                                </div>\r\n\r\n                                <div className=\"divider my-2\"></div>\r\n\r\n                                {/* Amounts */}\r\n                                <div className=\"space-y-2\">\r\n                                    <div className=\"flex justify-between text-sm\">\r\n                                        <span className=\"text-base-content/60\">Items ({items.filter(i => i.description).length})</span>\r\n                                        <span className=\"font-medium\">{formatCurrency(grossAmount)}</span>\r\n                                    </div>\r\n                                    {totalDeductions > 0 && (\r\n                                        <div className=\"flex justify-between text-sm\">\r\n                                            <span className=\"text-error\">Deductions</span>\r\n                                            <span className=\"font-medium text-error\">-{formatCurrency(totalDeductions)}</span>\r\n                                        </div>\r\n                                    )}\r\n                                    <div className=\"divider my-1\"></div>\r\n                                    <div className=\"flex justify-between items-center\">\r\n                                        <span className=\"font-bold\">Net Amount</span>\r\n                                        <span className=\"text-xl font-bold text-primary\">{formatCurrency(netAmount)}</span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Warning if exceeds fund */}\r\n                                {selectedFund && netAmount > Number(selectedFund.initialBalance) && (\r\n                                    <div className=\"alert alert-warning text-xs p-3\">\r\n                                        <AlertTriangle className=\"w-4 h-4\" />\r\n                                        <span>Amount exceeds fund balance!</span>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Fixed Bottom Action Bar */}\r\n            <div className=\"fixed bottom-0 left-0 right-0 bg-base-100 border-t border-base-300 px-6 lg:px-8 py-4 shadow-elevated z-20\">\r\n                <div className=\"max-w-7xl mx-auto flex justify-between items-center\">\r\n                    <div className=\"text-sm text-base-content/60\">\r\n                        Step {currentStep} of {STEPS.length}\r\n                    </div>\r\n                    <div className=\"flex gap-3\">\r\n                        {currentStep > 1 && (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={handleBack}\r\n                                className=\"btn btn-ghost gap-2\"\r\n                            >\r\n                                <ChevronLeft className=\"w-4 h-4\" />\r\n                                Back\r\n                            </button>\r\n                        )}\r\n                        {currentStep < 4 ? (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={handleNext}\r\n                                className=\"btn btn-primary gap-2\"\r\n                            >\r\n                                Next\r\n                                <ChevronRight className=\"w-4 h-4\" />\r\n                            </button>\r\n                        ) : (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={handleSubmit}\r\n                                disabled={isSubmitting || isLoading}\r\n                                className=\"btn btn-primary gap-2 min-w-[160px]\"\r\n                            >\r\n                                {isSubmitting ? (\r\n                                    <>\r\n                                        <span className=\"loading loading-spinner loading-sm\"></span>\r\n                                        Saving...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <CheckCircle2 className=\"w-4 h-4\" />\r\n                                        {isEditing ? \"Update\" : \"Create\"} Disbursement\r\n                                    </>\r\n                                )}\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default DisbursementFormPage;\r\n","usedDeprecatedRules":[]}]
